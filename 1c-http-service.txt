Функция mu1_tv_nku_sklad(Запрос)
	Ответ = Новый HTTPСервисОтвет(200);  
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
				"ВЫБРАТЬ ПЕРВЫЕ 20
				|	ТребованиеНакладная.Номер,
				|	ТребованиеНакладная.Дата,
				|	ТребованиеНакладная.Проект.Наименование КАК Проект,
				|	ТребованиеНакладная.Затребовал,
				|	ТребованиеНакладная.Получил
				|ИЗ
				|	Документ.ТребованиеНакладная КАК ТребованиеНакладная
				|ГДЕ
				|	ТребованиеНакладная.Получил = ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
				|	И ТребованиеНакладная.Затребовал <> ЗНАЧЕНИЕ(Справочник.ФизическиеЛица.ПустаяСсылка)
				|	И ТребованиеНакладная.Дата > &ДатаНачалаВыборки
				|
				|УПОРЯДОЧИТЬ ПО
				|	ТребованиеНакладная.Дата УБЫВ";
				
	Запрос.УстановитьПараметр("ДатаНачалаВыборки", ДобавитьМесяц(ТекущаяДата(), -1));  
	//Запрос.УстановитьПараметр("ДатаНачалаВыборки", ДобавитьМесяц(ТекущаяДата(), -200));
	Результат = Запрос.Выполнить();   	
	Выборка = Результат.Выбрать();

	МассивЗаявок = Новый Массив;
	Пока Выборка.Следующий() Цикл    
		Заявка = Новый Структура;
		Заявка.Вставить("Date", Формат(Выборка.Дата, "ДФ=""д ММММ гггг, Ч:мм"""));
		Заявка.Вставить("Num", Число(Выборка.Номер));
		Заявка.Вставить("Project", Выборка.Проект);
		Заявка.Вставить("Zatreboval", Строка(Выборка.Затребовал));
		МассивЗаявок.Добавить(Заявка);
	КонецЦикла;                                           
	
	Запись = Новый ЗаписьJSON;
	Запись.УстановитьСтроку();
	ЗаписатьJSON(Запись, МассивЗаявок, Новый НастройкиСериализацииJSON);
	СтрокаОтвета = Запись.Закрыть();
	
	Ответ.УстановитьТелоИзСтроки(СтрокаОтвета, КодировкаТекста.UTF8);	
	Ответ.Заголовки.Вставить("Content-Type","application/json; charset=utf-8");     
	Возврат Ответ;
КонецФункции

